# `src/plugins/storage/s3.js`

## Purpose

Provides authenticated object storage operations via Bun `S3Client` (Cloudflare R2 style config).

## Required Env

- `CLOUDFLARE_ACCESS_KEY_ID`
- `CLOUDFLARE_SECRET_ACCESS_KEY`
- `CLOUDFLARE_BUCKET_NAME`
- `CLOUDFLARE_PUBLIC_URL`

If any are missing, routes are not activated.

## Key Model

All objects are namespaced by user:

- `<user.sub>/<key>`

## Routes

- `PUT *`
  - upload request body stream
  - returns `{ status: "Saved to R2" }`
- `PURGE *`
  - delete object
  - returns `{ status: "Deleted from R2" }`
- `PROPFIND *`
  - list objects under user prefix
  - returns normalized file metadata array
- `PATCH *`
  - stream object bytes for download
  - returns `404` JSON when object does not exist

## Auth

All routes require `ctx.user`; otherwise return `401 Unauthorized`.

